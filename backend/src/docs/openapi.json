{
  "openapi": "3.0.3",
  "info": {
    "title": "CureNET API",
    "description": "Healthcare platform API: authentication, doctors, appointments, prescriptions, ratings, and admin.",
    "version": "1.0.0"
  },
  "servers": [
    { "url": "/api", "description": "API base path" }
  ],
  "tags": [
    { "name": "Authentication", "description": "Register, login, profile, password reset" },
    { "name": "Doctors", "description": "Doctor list, profile, slots, ratings" },
    { "name": "Appointments", "description": "Book and manage appointments" },
    { "name": "Prescriptions", "description": "Prescriptions for appointments" },
    { "name": "Ratings", "description": "Doctor ratings and reviews" },
    { "name": "Patients", "description": "Patient profile and data (patient role)" },
    { "name": "Admin", "description": "Admin-only: users, doctors, patients, analytics, logs" }
  ],
  "paths": {
    "/auth/register": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Register",
        "description": "Register a new patient or doctor. Admin cannot self-register.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["email", "password", "firstName", "lastName"],
                "properties": {
                  "email": { "type": "string", "format": "email" },
                  "password": { "type": "string", "minLength": 6 },
                  "firstName": { "type": "string" },
                  "lastName": { "type": "string" },
                  "role": { "type": "string", "enum": ["patient", "doctor"], "default": "patient" },
                  "phone": { "type": "string" },
                  "dateOfBirth": { "type": "string", "format": "date" },
                  "gender": { "type": "string", "enum": ["male", "female", "other"] },
                  "address": { "type": "string" },
                  "bmdcRegistrationNumber": { "type": "string" },
                  "department": { "type": "string" },
                  "experience": { "type": "integer" }
                }
              }
            }
          }
        },
        "responses": {
          "201": { "description": "Registered" },
          "400": { "description": "Validation error or email already registered" }
        }
      }
    },
    "/auth/login": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Login",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["password"],
                "properties": {
                  "email": { "type": "string" },
                  "phone": { "type": "string" },
                  "password": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Success" },
          "401": { "description": "Invalid credentials" },
          "403": { "description": "Account deactivated" }
        }
      }
    },
    "/auth/profile": {
      "get": {
        "tags": ["Authentication"],
        "summary": "Get my profile",
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "Current user profile" } }
      },
      "put": {
        "tags": ["Authentication"],
        "summary": "Update my profile",
        "security": [{ "bearerAuth": [] }],
        "requestBody": { "content": { "application/json": { "schema": { "type": "object", "properties": { "firstName": { "type": "string" }, "lastName": { "type": "string" }, "phone": { "type": "string" }, "address": { "type": "string" } } } } } },
        "responses": { "200": { "description": "Updated profile" } }
      }
    },
    "/auth/forgot-password": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Forgot password",
        "requestBody": { "content": { "application/json": { "schema": { "type": "object", "properties": { "email": { "type": "string" } } } } } },
        "responses": { "200": { "description": "Reset email sent if account exists" } }
      }
    },
    "/auth/reset-password": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Reset password with token",
        "requestBody": { "content": { "application/json": { "schema": { "type": "object", "properties": { "token": { "type": "string" }, "newPassword": { "type": "string" } } } } } },
        "responses": { "200": { "description": "Password reset" } }
      }
    },
    "/doctors": {
      "get": {
        "tags": ["Doctors"],
        "summary": "List doctors (public)",
        "description": "Returns only verified doctors. Used for Find Doctors and landing.",
        "parameters": [
          { "name": "department", "in": "query", "schema": { "type": "string" } },
          { "name": "limit", "in": "query", "schema": { "type": "integer" } }
        ],
        "responses": { "200": { "description": "List of doctors" } }
      }
    },
    "/doctors/{id}": {
      "get": {
        "tags": ["Doctors"],
        "summary": "Get doctor public profile",
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "200": { "description": "Doctor profile with patientCount" }, "404": { "description": "Doctor not found or not verified" } }
      }
    },
    "/doctors/{id}/available-slots": {
      "get": {
        "tags": ["Doctors"],
        "summary": "Get available time slots for a date",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } },
          { "name": "date", "in": "query", "required": true, "schema": { "type": "string", "format": "date" } }
        ],
        "responses": { "200": { "description": "Array of time slot strings (e.g. 09:00)" } }
      }
    },
    "/doctors/{id}/upcoming-slots": {
      "get": {
        "tags": ["Doctors"],
        "summary": "Get upcoming slots for next N days",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } },
          { "name": "days", "in": "query", "schema": { "type": "integer", "default": 14 } }
        ],
        "responses": { "200": { "description": "Slots per day with booked status" } }
      }
    },
    "/doctors/{id}/ratings": {
      "get": {
        "tags": ["Doctors", "Ratings"],
        "summary": "Get ratings for a doctor (public)",
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "200": { "description": "Summary and list of ratings" } }
      }
    },
    "/doctors/profile": {
      "get": {
        "tags": ["Doctors"],
        "summary": "Get my doctor profile",
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "Doctor profile" } }
      },
      "put": {
        "tags": ["Doctors"],
        "summary": "Update my doctor profile",
        "security": [{ "bearerAuth": [] }],
        "requestBody": { "content": { "application/json": { "schema": { "type": "object", "properties": { "department": { "type": "string" }, "consultationFee": { "type": "number" }, "bio": { "type": "string" } } } } } },
        "responses": { "200": { "description": "Updated profile" } }
      }
    },
    "/appointments": {
      "post": {
        "tags": ["Appointments"],
        "summary": "Create appointment (patient)",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["doctorId", "appointmentDate", "timeBlock"],
                "properties": {
                  "doctorId": { "type": "integer" },
                  "appointmentDate": { "type": "string", "format": "date" },
                  "timeBlock": { "type": "string" },
                  "type": { "type": "string", "enum": ["in_person", "video", "phone"], "default": "in_person" },
                  "reason": { "type": "string" },
                  "symptoms": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": { "201": { "description": "Appointment created" }, "409": { "description": "Slot already booked" } }
      },
      "get": {
        "tags": ["Appointments"],
        "summary": "List my appointments (patient)",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "status", "in": "query", "schema": { "type": "string" } }],
        "responses": { "200": { "description": "List of appointments" } }
      }
    },
    "/appointments/{id}": {
      "get": {
        "tags": ["Appointments"],
        "summary": "Get one appointment",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "200": { "description": "Appointment details" } }
      }
    },
    "/appointments/{id}/cancel": {
      "put": {
        "tags": ["Appointments"],
        "summary": "Cancel appointment",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "200": { "description": "Cancelled" } }
      }
    },
    "/appointments/{id}/approve": {
      "put": {
        "tags": ["Appointments"],
        "summary": "Approve appointment (doctor)",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "200": { "description": "Approved" } }
      }
    },
    "/appointments/{id}/reject": {
      "put": {
        "tags": ["Appointments"],
        "summary": "Reject appointment (doctor)",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "200": { "description": "Rejected" } }
      }
    },
    "/appointments/{id}/start": {
      "put": {
        "tags": ["Appointments"],
        "summary": "Start appointment (doctor)",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "200": { "description": "Started" } }
      }
    },
    "/appointments/{id}/complete": {
      "put": {
        "tags": ["Appointments"],
        "summary": "Complete appointment (doctor)",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "200": { "description": "Completed" } }
      }
    },
    "/prescriptions/appointment/{id}": {
      "get": {
        "tags": ["Prescriptions"],
        "summary": "Get prescription by appointment",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "200": { "description": "Prescription if exists" } }
      }
    },
    "/prescriptions": {
      "post": {
        "tags": ["Prescriptions"],
        "summary": "Create prescription (doctor)",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["appointmentId"],
                "properties": {
                  "appointmentId": { "type": "integer" },
                  "diagnosis": { "type": "string" },
                  "medicines": { "type": "array", "items": { "type": "object" } },
                  "notes": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": { "201": { "description": "Prescription created" } }
      }
    },
    "/ratings/doctor/{id}": {
      "get": {
        "tags": ["Ratings"],
        "summary": "Get ratings for doctor (public)",
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "200": { "description": "Summary and ratings list" } }
      }
    },
    "/ratings": {
      "post": {
        "tags": ["Ratings"],
        "summary": "Submit rating (patient)",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["doctorId", "appointmentId", "rating"],
                "properties": {
                  "doctorId": { "type": "integer" },
                  "appointmentId": { "type": "integer" },
                  "rating": { "type": "number" },
                  "review": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": { "201": { "description": "Rating created" } }
      }
    },
    "/ratings/my-ratings": {
      "get": {
        "tags": ["Ratings"],
        "summary": "My ratings (patient)",
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "List of my ratings" } }
      }
    },
    "/admin/stats": {
      "get": {
        "tags": ["Admin"],
        "summary": "Dashboard stats",
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "Counts: doctors, patients, appointments, pending doctors, today, etc." } }
      }
    },
    "/admin/users": {
      "get": {
        "tags": ["Admin"],
        "summary": "List users",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "page", "in": "query", "schema": { "type": "integer" } },
          { "name": "limit", "in": "query", "schema": { "type": "integer" } },
          { "name": "role", "in": "query", "schema": { "type": "string", "enum": ["admin", "patient", "doctor"] } },
          { "name": "search", "in": "query", "schema": { "type": "string" } },
          { "name": "isActive", "in": "query", "schema": { "type": "boolean" } }
        ],
        "responses": { "200": { "description": "Paginated users" } }
      },
      "post": {
        "tags": ["Admin"],
        "summary": "Create user",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["email", "password", "firstName", "lastName"],
                "properties": {
                  "email": { "type": "string" },
                  "password": { "type": "string" },
                  "firstName": { "type": "string" },
                  "lastName": { "type": "string" },
                  "role": { "type": "string", "enum": ["admin", "patient", "doctor"] },
                  "phone": { "type": "string" },
                  "bmdcRegistrationNumber": { "type": "string" },
                  "department": { "type": "string" },
                  "experience": { "type": "integer" }
                }
              }
            }
          }
        },
        "responses": { "201": { "description": "User created" } }
      }
    },
    "/admin/users/{id}": {
      "put": {
        "tags": ["Admin"],
        "summary": "Update user",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "firstName": { "type": "string" },
                  "lastName": { "type": "string" },
                  "email": { "type": "string" },
                  "role": { "type": "string" },
                  "isActive": { "type": "boolean" },
                  "password": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": { "200": { "description": "User updated" } }
      }
    },
    "/admin/doctor-verifications": {
      "get": {
        "tags": ["Admin"],
        "summary": "List doctors (admin)",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "search", "in": "query", "schema": { "type": "string" } },
          { "name": "department", "in": "query", "schema": { "type": "string" } },
          { "name": "verified", "in": "query", "schema": { "type": "boolean" } }
        ],
        "responses": { "200": { "description": "Doctors with verification status" } }
      }
    },
    "/admin/doctors/{id}/verify": {
      "put": {
        "tags": ["Admin"],
        "summary": "Verify doctor",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "200": { "description": "Doctor verified" } }
      }
    },
    "/admin/doctors/{id}/unverify": {
      "put": {
        "tags": ["Admin"],
        "summary": "Unverify doctor",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "200": { "description": "Doctor unverified" } }
      }
    },
    "/admin/patients": {
      "get": {
        "tags": ["Admin"],
        "summary": "List patients",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "search", "in": "query", "schema": { "type": "string" } }],
        "responses": { "200": { "description": "Paginated patients" } }
      }
    },
    "/admin/appointments": {
      "get": {
        "tags": ["Admin"],
        "summary": "List appointments by date",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "date", "in": "query", "schema": { "type": "string", "format": "date" } }],
        "responses": { "200": { "description": "Appointments for date" } }
      }
    },
    "/admin/analytics/appointments": {
      "get": {
        "tags": ["Admin"],
        "summary": "Appointment analytics",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "period", "in": "query", "schema": { "type": "integer", "default": 7 } }],
        "responses": { "200": { "description": "Status/type counts, daily counts" } }
      }
    },
    "/admin/logs": {
      "get": {
        "tags": ["Admin"],
        "summary": "Audit logs",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "type", "in": "query", "schema": { "type": "string" } },
          { "name": "from", "in": "query", "schema": { "type": "string", "format": "date" } },
          { "name": "to", "in": "query", "schema": { "type": "string", "format": "date" } }
        ],
        "responses": { "200": { "description": "Paginated audit logs" } }
      }
    }
  }
  ,
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "JWT from login/register"
      }
    }
  }
}
